{"source":"webpackJsonp([12],{693:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var a,r=p(n(0)),o=p(n(9)),i=p(n(7)),u=p(n(8)),c=p(n(10)),s=p(n(11)),d=n(1),l=(p(d),n(54)),f=p(n(236));function p(e){return e&&e.__esModule?e:{default:e}}var m=(0,l.wrapper)(f.default)(a=function(e){function t(){return(0,i.default)(this,t),(0,c.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,u.default)(t,[{key:\"render\",value:function(){return this.props.monkeyKing((0,r.default)({},this.props,{path:\"root\"}))}}]),t}(d.Component))||a;t.default=m,e.exports=t.default},694:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a,r,o=g(n(0)),u=g(n(55)),c=g(n(56)),i=g(n(7));t.default=function(e){var t=new d.action(e),n=f.default.actionCreator((0,o.default)({},e,{metaAction:t})),a=new h((0,o.default)({},e,{metaAction:t,extendAction:n})),r=(0,o.default)({},t,n.gridAction,a);return t.config({metaHandlers:r}),r};var s=g(n(1)),d=n(54),l=n(40),f=g(n(812)),p=g(n(172)),m=n(71);n(6);function g(e){return e&&e.__esModule?e:{default:e}}var h=(a=function e(t){(0,i.default)(this,e),r.call(this),this.metaAction=t.metaAction,this.extendAction=t.extendAction,this.config=p.default.current,this.webapi=this.config.webapi},r=function(){var t,n,a,r,i=this;this.onInit=function(e){var t=e.component,n=e.injections;i.extendAction.gridAction.onInit({component:t,injections:n}),i.component=t,(i.injections=n).reduce(\"init\");var a=sessionStorage.getItem(\"currentOrgStatus\");1!=a&&2!=a&&i.metaAction.sf(\"data.hideBackBtn\",!0),i.isCurrentOrg=!1,i.load()},this.load=(t=(0,c.default)(u.default.mark(function e(t){var n,a,r,o;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.metaAction.sf(\"data.other.loading\",!0),n=i.getColumns(),e.next=4,i.getData();case 4:if(a=e.sent,i.isCurrentOrg&&0!=a.length)return e.next=8,i.webapi.org.updateCurrentOrg({orgId:a[0].id});e.next=10;break;case 8:e.sent,document.querySelector(\".currentOrgName\").innerHTML=a[0].name;case 10:if(r=sessionStorage.getItem(\"currentOrgStatus\"),void 0,1!=r&&2!=r)return e.next=15,i.webapi.portal.init();e.next=21;break;case 15:return e.next=17,i.webapi.portal.portal();case 17:o=e.sent,t&&(o.org=t),o.user?i.metaAction.context.set(\"currentUser\",o.user):(i.metaAction.context.set(\"currentUser\",void 0),i.component.props.onRedirect&&i.config.goAfterLogout&&i.component.props.onRedirect(i.config.goAfterLogout)),o.org?i.metaAction.context.set(\"currentOrg\",o.org):(i.metaAction.context.set(\"currentOrg\",void 0),i.component.props.onRedirect&&i.config.goAfterLogout&&i.component.props.onRedirect(i.config.goAfterLogout));case 21:if(0==a.length)return i.injections.reduce(\"load\",n,a),i.injections.reduce(\"initQueryList\",a),i.metaAction.sf(\"data.isShowSearch\",!1),sessionStorage.currentOrgStatus=2,i.metaAction.sf(\"data.hideBackBtn\",!1),i.component.props.hideHead(),i.metaAction.sf(\"data.other.loading\",!1),e.abrupt(\"return\");e.next=30;break;case 30:i.injections.reduce(\"load\",n,a),i.injections.reduce(\"initQueryList\",a),i.metaAction.sf(\"data.isShowSearch\",!1),i.metaAction.sf(\"data.other.loading\",!1);case 34:case\"end\":return e.stop()}},e,i)})),function(e){return t.apply(this,arguments)}),this.addManage=(0,c.default)(u.default.mark(function e(){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.component.props.setPortalContent(\"新建企业\",\"ttk-edf-app-company-manage-add\");case 1:case\"end\":return e.stop()}},e,i)})),this.manageBlur=function(){},this.manageResearch=function(e){},this.goRegister=function(e){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!i.config.apps[\"edfx-app-register\"])throw\"不存在edfx-app-register应用，该功能不能使用\";i.component.props.onRedirect({appName:\"ttk-edf-app-company-manage-add\"})},this.goCompanyManage=function(e){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!i.config.apps[\"ttk-edf-app-company-manage\"])throw\"ttk-edf-app-company-manage应用，该功能不能使用\";i.component.props.onRedirect({appName:\"ttk-edf-app-company-manage\"})},this.fieldChange=function(e,n){i.metaAction.gf(\"data.form\").toJS();var t=i.getColumns(),a=[],r=i.metaAction.gf(\"data.queryList\").toJS();r.map(function(e,t){return-1<e.name.indexOf(n)&&a.push(e),a}),\"\"==n?i.injections.reduce(\"load\",t,r):i.injections.reduce(\"load\",t,a)},this.getListColumns=function(){var t=l.DataGrid.Column,r=l.DataGrid.Cell,e=i.metaAction.gf(\"data.columns\").toJS(),o=[];i.metaAction.gf(\"data.list\")&&(o=i.metaAction.gf(\"data.list\").toJS());var n=[];return e.forEach(function(a){var e=s.default.createElement(t,{name:a.id,isResizable:!1,columnKey:a.id,flexGrow:1,width:\"name\"==a.name||\"remark\"==a.name?\"name\"==a.name?270:70:150,header:s.default.createElement(r,{name:\"header\",className:\"ttk-edf-app-company-manage-headerBgColor\"},a.columnName),cell:function(e){if(\"lastLoginTime\"==a.name)return s.default.createElement(r,null,\"\"+o[e.rowIndex].lastLoginTime);if(\"contactNumber\"==a.name)return s.default.createElement(r,null,o[e.rowIndex].createTime.replace(/-/g,\".\")+\"-\"+o[e.rowIndex].expireTime.replace(/-/g,\".\"));if(\"status\"==a.name)return o[e.rowIndex].status==m.consts.ORGTATUS_001?s.default.createElement(r,null,\"正常\"):o[e.rowIndex].status==m.consts.ORGTATUS_002?s.default.createElement(r,null,\"过期\"):s.default.createElement(r,null,\"试用期\");if(\"remark\"==a.name){var t=o[e.rowIndex].isOtherUser;return s.default.createElement(r,null,s.default.createElement(\"span\",{href:\"javascript:\",className:\"ttk-edf-app-company-manage-font\",onClick:1==t?\"\":i.delOrg.bind(i,o[e.rowIndex].id)},s.default.createElement(l.Icon,{disabled:t,type:\"shanchu\",fontFamily:\"edficon\",style:{fontSize:\"24px\"}})))}var n=o[e.rowIndex][a.name];return s.default.createElement(r,{className:\"portalOrgName\",title:n,onClick:function(){i.setCurrentOrg(o[e.rowIndex])}},\" \",n)}});n.push(e)}),n},this.back=function(){i.component.props.setPortalContent(\"门户首页\",\"edfx-app-portal\",{isShowMenu:!1,isTabsStyle:!1})},this.getListRowsCount=function(){var e=i.metaAction.gf(\"data.list\");return e?e.size:0},this.isCurrentOrg=!1,this.delOrg=(n=(0,c.default)(u.default.mark(function e(t){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.metaAction.context.get(\"currentOrg\"),e.next=3,i.metaAction.modal(\"confirm\",{title:\"删除\",content:\"删除企业将永久删除该企业相关的数据，无法恢复，请谨慎操作。您确认要删除企业吗?\",className:\"ttk-edf-app-company-manage-modal\"});case 3:if(e.sent)return e.next=7,i.webapi.org.del({id:t});e.next=12;break;case 7:e.sent&&(i.component.props.updateOrgList(),i.metaAction.toast(\"success\",\"删除成功\"),t==n.id?i.isCurrentOrg=!0:i.isCurrentOrg=!1),i.load(),e.next=13;break;case 12:return e.abrupt(\"return\");case 13:case\"end\":return e.stop()}},e,i)})),function(e){return n.apply(this,arguments)}),this.setCurrentOrg=(a=(0,c.default)(u.default.mark(function e(t){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.webapi.org.updateCurrentOrg({orgId:t.id});case 2:if(e.sent,sessionStorage.currentOrgStatus=null,e.t0=i.component.props.onPortalReload,e.t0)return e.next=8,i.component.props.onPortalReload();e.next=8;break;case 8:i.metaAction.context.set(\"currentOrg\",t),i.component.props.setPortalContent(\"门户首页\",\"edfx-app-portal\",{isShowMenu:!1,isTabsStyle:!1});case 10:case\"end\":return e.stop()}},e,i)})),function(e){return a.apply(this,arguments)}),this.modifyDetail=function(n){return function(e){var t=n||null;i.add(t)}},this.getData=(r=(0,c.default)(u.default.mark(function e(t){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.webapi.org.queryList();case 2:return n=e.sent,e.abrupt(\"return\",n);case 4:case\"end\":return e.stop()}},e,i)})),function(e){return r.apply(this,arguments)}),this.getColumns=function(){return[{columnName:\"企业名称\",id:\"name\",name:\"name\"},{columnName:\"使用状态\",id:\"status\",name:\"status\"},{columnName:\"最后登录日期\",id:\"lastLoginTime\",name:\"lastLoginTime\"},{columnName:\"授权日期\",id:\"contactNumber\",name:\"contactNumber\"},{columnName:\"操作\",id:\"remark\",name:\"remark\"}]}},a);e.exports=t.default},695:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a=s(n(0)),r=s(n(7));t.default=function(e){var t=new i.reducer(e),n=new d((0,a.default)({},e,{metaReducer:t}));return(0,a.default)({},t,n)};var o=n(13),i=n(54),u=s(n(172)),c=n(237);function s(e){return e&&e.__esModule?e:{default:e}}var d=function e(t){var a=this;(0,r.default)(this,e),this.init=function(e,t){var n=(0,c.getInitState)();return a.metaReducer.init(e,n)},this.load=function(e,t,n){return e=a.metaReducer.sf(e,\"data.columns\",(0,o.fromJS)(t)),n&&(e=a.metaReducer.sf(e,\"data.list\",(0,o.fromJS)(n))),e},this.initQueryList=function(e,t){return e=a.metaReducer.sf(e,\"data.queryList\",(0,o.fromJS)(t))},this.metaReducer=t.metaReducer,this.config=u.default.current};e.exports=t.default},812:function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a},i=n(40);t.default={actionCreator:function(e){return{gridAction:new i.GridDecorator.action((0,o.default)({},e,{gridOption:{details:{path:\"data.list\",cellClassName:\"app-archives-list-cell\",emptyRow:{},getColNames:function(e){return[]},cellIsReadonly:function(e,t,n){return!1}}}}))}},reducerCreator:function(e){return{gridReducer:new i.GridDecorator.reducer((0,o.default)({},e,{gridOption:{details:{path:\"data.list\",cellClassName:\"app-archives-list-cell\",emptyRow:{},getColNames:function(e){return[]},cellIsReadonly:function(e,t,n){return!1}}}}))}}},e.exports=t.default}});"}