{"source":"webpackJsonp([0],{792:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var n,r=p(a(0)),i=p(a(9)),o=p(a(7)),d=p(a(8)),u=p(a(10)),c=p(a(11)),s=a(1),l=(p(s),a(54)),f=p(a(302));function p(e){return e&&e.__esModule?e:{default:e}}var h=(0,l.wrapper)(f.default)(n=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,d.default)(t,[{key:\"render\",value:function(){return this.props.monkeyKing((0,r.default)({},this.props,{path:\"root\"}))}}]),t}(s.Component))||n;t.default=h,e.exports=t.default},793:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=c(a(0)),n=c(a(7));t.default=function(e){var t=new i.action(e),a=new s((0,r.default)({},e,{metaAction:t})),n=(0,r.default)({},t,a);return t.config({metaHandlers:n}),n};c(a(1));var i=a(54),o=c(a(100)),d=a(6),u=a(205);function c(e){return e&&e.__esModule?e:{default:e}}var s=function e(t){var i=this;(0,n.default)(this,e),this.onInit=function(e){var t=e.component,a=e.injections;i.component=t,i.injections=a;var n=(0,u.getInitState)(),r=n.data.currentAppName;a.reduce(\"init\",{initState:n}),d.history.listen(\"ttk-edf-app-root\",i.listen),i.onRedirect({appName:d.history.getChildApp(\"ttk-edf-app-root\")||r})},this.listen=function(e,t,a){var n=(0,u.getInitState)().data.currentAppName,r=e||n;r!=(i.metaAction.gf(\"data.currentAppName\")||n)&&i.injections.reduce(\"redirect\",r)},this.onRedirect=function(e){var t=e.appName;d.history.pushChildApp(\"ttk-edf-app-root\",t)},this.componentWillUnmount=function(){d.history.unlisten(\"ttk-edf-app-root\",i.listen)},this.metaAction=t.metaAction,this.config=o.default.current};e.exports=t.default},794:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n,r,i=c(a(0)),o=c(a(7));t.default=function(e){var t=new d.reducer(e),a=new s((0,i.default)({},e,{metaReducer:t}));return(0,i.default)({},t,a)};a(13);var d=a(54),u=c(a(100));a(205),a(6);function c(e){return e&&e.__esModule?e:{default:e}}var s=(n=function e(t){(0,o.default)(this,e),r.call(this),this.metaReducer=t.metaReducer,this.config=u.default.current},r=function(){var a=this;this.init=function(e,t){return a.metaReducer.init(e,t.initState)},this.redirect=function(e,t){return a.metaReducer.sf(e,\"data.currentAppName\",t)}},n);e.exports=t.default},795:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.default=void 0;var n,r=p(a(0)),i=p(a(9)),o=p(a(7)),d=p(a(8)),u=p(a(10)),c=p(a(11)),s=a(1),l=(p(s),a(54)),f=p(a(303));function p(e){return e&&e.__esModule?e:{default:e}}var h=(0,l.wrapper)(f.default)(n=function(e){function t(){return(0,o.default)(this,t),(0,u.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,c.default)(t,e),(0,d.default)(t,[{key:\"render\",value:function(){return this.props.monkeyKing((0,r.default)({},this.props,{path:\"root\"}))}}]),t}(s.Component))||n;t.default=h,e.exports=t.default},796:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(a(0)),u=n(a(18)),o=n(a(55)),i=n(a(56)),c=n(a(7));t.default=function(e){var t=new d.action(e),a=new p((0,r.default)({},e,{metaAction:t})),n=(0,r.default)({},t,a);return t.config({metaHandlers:n}),n};var s=n(a(1)),d=a(54),l=n(a(206)),f=(a(13),n(a(15)),a(207),a(40));function n(e){return e&&e.__esModule?e:{default:e}}var p=function e(t){var a,n,d=this;(0,c.default)(this,e),this.onInit=function(e){var t=e.component,a=e.injections;d.component=t,d.injections=a,d.injections.reduce(\"init\"),d.load()},this.load=(a=(0,i.default)(o.default.mark(function e(t){var a,n,r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.webapi.query.queryVoucher();case 2:return a=e.sent,n=d.handleTreeData(a),d.injections.reduce(\"load\",n),e.next=7,d.webapi.query.queryTableFields();case 7:r=e.sent,d.injections.reduce(\"fields\",r),t?t&&(d.metaAction.sf(\"data.selectedKeys\",t+\"head\"),(i=d.metaAction.gf(\"data.expandedKeys\")).push(String(t)),d.metaAction.sf(\"data.expandedKeys\",i),d.metaAction.sf(\"data.voucherId\",t),d.loadDetailData(\"thead\",t)):(d.metaAction.sf(\"data.selectedKeys\",a[0].id+\"head\"),d.metaAction.sf(\"data.expandedKeys\",[String(a[0].id)]),d.metaAction.sf(\"data.voucherId\",String(a[0].id)),d.loadDetailData(\"thead\",a[0].id));case 10:case\"end\":return e.stop()}},e,d)})),function(e){return a.apply(this,arguments)}),this.loadDetailData=(n=(0,i.default)(o.default.mark(function e(t,a,n){var r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=void 0,\"thead\"==t)return e.next=4,d.webapi.query.queryTableHeadData({voucherId:a});e.next=7;break;case 4:r=e.sent,e.next=17;break;case 7:if(\"tbody\"==t)return e.next=10,d.webapi.query.queryTableBodyData({voucherId:a,voucherTableId:n});e.next=13;break;case 10:r=e.sent,e.next=17;break;case 13:if(\"tbodys\"==t)return e.next=16,d.webapi.query.queryTablesData({voucherId:a});e.next=17;break;case 16:r=e.sent;case 17:d.metaAction.sf(\"data.other.type\",t),d.injections.reduce(\"list\",r);case 19:case\"end\":return e.stop()}},e,d)})),function(e,t,a){return n.apply(this,arguments)}),this.handleTreeData=function(e){for(var t=[],a=0;a<e.length;a++){var n={};n.name=e[a].name,n.id=e[a].id,n.voucherId=e[a].id,n.type=\"root\",n.children=[],n.children.push({name:e[a].header.name,id:e[a].id+\"head\",selectable:!0,voucherId:e[a].id,type:\"thead\"});for(var r=[],i=0;i<e[a].body.tables.length;i++)r.push({name:e[a].body.tables[i].caption,id:e[a].body.tables[i].id,voucherId:e[a].id,selectable:!0,type:\"tbody\"});n.children.push({name:e[a].body.name,id:e[a].id+\"body\",children:r,voucherId:e[a].id,type:\"tbodys\"}),t.push(n)}return t},this.loopTreeChildren=function(e,t){return e?e.map(function(e){return e.children&&e.children.length?s.default.createElement(f.Tree.TreeNode,{key:e.id,title:e.name,voucherId:e.voucherId,type:e.type},d.loopTreeChildren(e.children)):s.default.createElement(f.Tree.TreeNode,{key:e.id,title:e.name,voucherId:e.voucherId,type:e.type})}):null},this.selectType=function(e,t){var a=t.node.props.eventKey;d.metaAction.sf(\"data.selectedKeys\",a);var n=t.node.props.type,r=t.node.props.voucherId;d.metaAction.sf(\"data.voucherId\",r);var i=void 0;if(\"thead\"==n)i=null,d.loadDetailData(n,r,i);else if(\"tbody\"==n)i=a,d.loadDetailData(n,r,i);else{var o=d.metaAction.gf(\"data.expandedKeys\");-1!=o.indexOf(a)?o.splice(o.indexOf(a),1):o.push(a),d.metaAction.sf(\"data.other.ts\",(new Date).getTime()),d.metaAction.sf(\"data.expandedKeys\",o),\"tbodys\"==n&&d.loadDetailData(n,r)}},this.updateExpandedKeys=function(e){d.metaAction.sf(\"data.expandedKeys\",e)},this.getListRowsCount=function(){return d.metaAction.gf(\"data.list\").size},this.getListColumns=function(){var a=d.metaAction.gf(\"data.list\").toJS(),e=d.metaAction.gf(\"data.fields\").toJS(),t=d.metaAction.gf(\"data.other.type\"),n=[],r=f.DataGrid.Column,i=f.DataGrid.Cell,o=void 0;return e&&a&&t&&(\"thead\"==t?o=e.header:\"tbody\"==t?o=e.body:\"tbodys\"==t&&(o=e.table||{voucherId:\"单据ID\",id:\"单据表体id\",name:\"字段名称\",caption:\"字段标题\",isVisible:\"是否显示\",colIndex:\"显示顺序\",createTime:\"创建时间\"}),(0,u.default)(o).forEach(function(t){var e=s.default.createElement(r,{flexGrow:1,width:50,header:s.default.createElement(i,{name:\"header\"},o[t]),cell:function(e){return\"isSystem\"==t||\"isMustSelect\"==t||\"isVisible\"==t?s.default.createElement(i,null,s.default.createElement(\"a\",null,0==a[e.rowIndex][t]?\"否\":\"是\")):s.default.createElement(i,null,s.default.createElement(\"a\",null,a[e.rowIndex][t]))}});n.push(e)})),n},this.isSelectAll=function(){var e=d.metaAction.gf(\"data.list\");return!(!e||0==e.size)&&e.every(function(e){return e.get(\"selected\")})},this.selectAll=function(){return function(e){d.injections.reduce(\"selectAll\",e.target.checked)}},this.selectRow=function(t){return function(e){d.injections.reduce(\"selectRow\",t,e.target.checked)}},this.pageChanged=function(e,t){var a=d.metaAction.gf(\"data.filter\").toJS();d.load({currentPage:e,pageSize:t},a)},this.addVoucher=(0,i.default)(o.default.mark(function e(){var t;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.metaAction.modal(\"show\",{title:\"新增\",children:d.metaAction.loadApp(\"ttk-edf-app-voucher-setting\",{store:d.component.props.store,actionType:\"add\"})});case 2:(t=e.sent)&&d.load(t.id);case 4:case\"end\":return e.stop()}},e,d)})),this.modifyVoucher=(0,i.default)(o.default.mark(function e(){var t,a,n,r;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.metaAction.gf(\"data.voucherId\")){e.next=3;break}return e.abrupt(\"return\");case 3:return a=d.metaAction.gf(\"data.other.tree\").toJS(),n=a.find(function(e){return e.id==t}),e.next=7,d.metaAction.modal(\"show\",{title:\"新增\",children:d.metaAction.loadApp(\"ttk-edf-app-voucher-setting\",{store:d.component.props.store,actionType:\"modify\",data:n})});case 7:(r=e.sent)&&console.log(r);case 9:case\"end\":return e.stop()}},e,d)})),this.delType=(0,i.default)(o.default.mark(function e(){var t,a;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d.metaAction.gf(\"data.filter.parentId\")){e.next=4;break}return d.metaAction.toast(\"error\",\"请选中删除项\"),e.abrupt(\"return\");case 4:return e.next=6,d.metaAction.modal(\"confirm\",{title:\"删除\",content:\"确认删除?\"});case 6:if(e.sent)return t=d.metaAction.gf(\"data.filter.parentId\"),e.next=11,d.webapi.menu.deleteBatch([{id:t}]);e.next=15;break;case 11:e.sent,d.metaAction.toast(\"success\",\"删除成功\"),a=d.metaAction.gf(\"data.pagination\").toJS(),d.load(a);case 15:case\"end\":return e.stop()}},e,d)})),this.addDetail=(0,i.default)(o.default.mark(function e(){var t,a,n,r,i;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.metaAction.gf(\"data.voucherId\"),a=d.metaAction.gf(\"data.other.type\"),n=null,\"tbody\"==a&&(n=d.metaAction.gf(\"data.selectedKeys\")),e.next=6,d.metaAction.modal(\"show\",{title:\"新增\",width:500,children:d.metaAction.loadApp(\"ttk-edf-app-voucher-detail-setting\",{store:d.component.props.store,actionType:\"add\",voucherId:t,target:a,voucherTableId:n})});case 6:if(!e.sent){e.next=18;break}if(\"tbodys\"==a)return e.next=11,d.webapi.query.queryVoucher();e.next=17;break;case 11:r=e.sent,i=d.handleTreeData(r),d.injections.reduce(\"load\",i),d.loadDetailData(a,t,n),e.next=18;break;case 17:d.loadDetailData(a,t,n);case 18:case\"end\":return e.stop()}},e,d)})),this.modifyDetail=function(t){return(0,i.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.metaAction.modal(\"show\",{title:\"修改\",children:d.metaAction.loadApp(\"edfx-app-portal-menu-detail\",{store:d.component.props.store,id:t})});case 2:e.sent&&d.reload();case 4:case\"end\":return e.stop()}},e,d)}))},this.batchDelDetail=(0,i.default)(o.default.mark(function e(){var t,a,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=d.metaAction.gf(\"data.list\"))&&0!=t.size||d.metaAction.toast(\"error\",\"请选中删除项\"),(a=t.filter(function(e){return e.get(\"selected\")}))&&0!=a.size||d.metaAction.toast(\"error\",\"请选中删除项\"),e.next=6,d.metaAction.modal(\"confirm\",{title:\"删除\",content:\"确认删除?\"});case 6:if(e.sent){e.next=9;break}return e.abrupt(\"return\");case 9:return n=a.map(function(e){return{id:e.get(\"id\")}}).toJS(),e.next=12,d.webapi.menu.deleteBatch(n);case 12:d.metaAction.toast(\"success\",\"删除成功\"),d.reload();case 14:case\"end\":return e.stop()}},e,d)})),this.columnSetting=(0,i.default)(o.default.mark(function e(){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.metaAction.modal(\"show\",{title:\"栏目设置\",children:d.metaAction.loadApp(\"edfx-app-column-setting\",{store:d.component.props.store,columnCode:\"menuList\"})});case 2:e.sent&&d.reload();case 4:case\"end\":return e.stop()}},e,d)})),this.metaAction=t.metaAction,this.config=l.default.current,this.webapi=this.config.webapi};e.exports=t.default},797:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=u(a(0)),i=u(a(7));t.default=function(e){var t=new r.reducer(e),a=new c((0,n.default)({},e,{metaReducer:t}));return(0,n.default)({},t,a)};var r=a(54),o=a(207),d=(u(a(206)),a(13));a(6);function u(e){return e&&e.__esModule?e:{default:e}}var c=function e(t){var r=this;(0,i.default)(this,e),this.init=function(e,t){return r.metaReducer.init(e,(0,o.getInitState)())},this.load=function(e,t){return e=r.metaReducer.sf(e,\"data.other.tree\",(0,d.fromJS)(t))},this.fields=function(e,t){return e=r.metaReducer.sf(e,\"data.fields\",(0,d.fromJS)(t))},this.list=function(e,t){return e=r.metaReducer.sf(e,\"data.list\",(0,d.fromJS)(t))},this.selectAll=function(e,t){var a=r.metaReducer.gf(e,\"data.list\");if(!a||0==a.size)return e;for(var n=0;n<a.size;n++)e=r.metaReducer.sf(e,\"data.list.\"+n+\".selected\",t);return e},this.selectRow=function(e,t,a){return e=r.metaReducer.sf(e,\"data.list.\"+t+\".selected\",a)},this.metaReducer=t.metaReducer};e.exports=t.default}});"}